\section{Upper bounds}

A knowledge of an upper bound $\bar{t}$ affects the number of variables in all studied models. 
Particularly in the decision versions, the iterative approach can be terminated once the solution is not satisfactory for broadcast time limit $\bar{t}-1$.
The algorithms presented in this section iteratively construct broadcast forest $T_i, i=1,2,\dots$.
\subsection{Matching heuristic}

A fast straightforward algorithm determining an upper bound is based on repetitive construction of a matching between already connected nodes and their neighbors.
Initially, the constructed broadcast forest consists of isolated sources. 
In each iteration, the nodes already in the forest are sorted according to the number of neighbors not yet added to the forest.
For each node we then select a neighbor to be appended to the forest.
Let $T_s=(V_s,A_s)$ be the tree rooted at source $s\in S$, and let $T=(V_T, A_T)=\{T_s:s\in S\}$ be the broadcast forest.
Further, nodest of the broadcast forest are numbered by integers $V_T=\{v_1,\dots,v_{|V_T|}\}$.
Alg. \ref{alg:matchheur} formalizes the steps.
%\begin{algorithm}[]
%\KwData{$G=(V,E), S\subseteq V$}
%\textbf{for }$s\in S\textbf{ do } V_s\leftarrow \{s\}, A_s\leftarrow\emptyset$\;
%$t\leftarrow 0$\;
%\While{$V_T\neq V$} {
%	Sort nodes in $V_T$ increasingly by the number of neighbors in $V\setminus V_T$\;
%	$W\leftarrow\emptyset$\;
%	\For{$u\in V_T$} {
%		Find $v\in V\setminus (V_T\cup W)$ such that $(u,v)\in A$\;
%		$W\leftarrow W\cup\{v\}$\;
%	}
%	$A_T\leftarrow A_T\cup \{\{u,w\}: u\in V_T, w\in N(u)\cap W\}$\;
%	$V_T\leftarrow V_T\cup W$\;
%	$t\leftarrow t+1$\;
%}
%\Return t\;
%%\Return $\lceil k/s \rceil$\;
% \caption{A greedy matching heuristic method for determining an upper bound}
%\label{alg:matchheur}
%\end{algorithm}

\begin{algorithm}[]
\KwData{$G=(V,E), S\subseteq V$}
\textbf{for }$s\in S\textbf{ do } V_s\leftarrow \{s\}, A_s\leftarrow\emptyset$\;
$t\leftarrow 0$\;
\While{$V_T\neq V$} {
	Sort nodes in $V_T$ so that $i<j\Leftrightarrow |N(v_i)\cap(V\setminus V_T)|<|N(v_j)\cap (V\setminus V_T)|$\;
	$W\leftarrow\emptyset$\;
	$D\leftarrow\emptyset$\;
	\For{$i=1,\dots,|V_T|$} {
		Find $v_j\in V\setminus (V_T\cup W)$ such that $(v_i,v_j)\in A$\;
		$W\leftarrow W\cup\{v_j\}$\;
		$D\leftarrow D\cup\{\left(v_i,v_j\right)\}$\;
	}
	$V_T\leftarrow V_T\cup W$\;
	$A_T\leftarrow A_T\cup D$\;
	$t\leftarrow t+1$\;
}
\Return t\;
%\Return $\lceil k/s \rceil$\;
 \caption{A greedy matching heuristic method for determining an upper bound}
\label{alg:matchheur}
\end{algorithm}
The selection of a neighbor (line 7) can be done arbitrarily, or according to some strategy such as neighbor with maximum degree is selected first.
Note that for determining an upper bound, it is not necessary to store arcs sets $A_T$ and $D$, because we merely count the number of iterations.
In order to construct an actual solution with broadcast time equal to the upper bound, the arcs sets are needed.
Matchings created in each iteration are not necessarily maximum.

\subsection{Restricted binomial tree method}

The following inexact method is based on the idea of finding maximum cardinality matching in $G\left[V_{T_i},V\setminus V_{T_i}\right]$, and extending $T_i$ by this matching.
It means that in each iteration $i$, the maximum possible number of nodes are informed.
The maximum cardinality matching can be regarded as finding $|V_{T_i}|$ node-disjoint  binomial trees of order at most one with roots in $V_{T_i}$, maximizing the number of edges.
By generalizing this notion, we iteratively look for $|V_{T_i}|$ node-disjoint (pruned) binomial trees of an arbitrary given order $k$ valued between 1 and $n-|S|$.
Even though this problem is NP-hard for $k\geq 2$ \cite{jansen95}, it is expected that the computational time is sound in most practical instances.
After obtaining the set of binomial trees, first $p$ nodes in each tree are selected and added to the broadcast forest.
The parameter $p\in \{1,\dots,2^k\}$ is also a part of the input.
\begin{algorithm}[]
\KwData{$G=(V,E), S\subseteq V, k\in \{1,\dots,n-|S|\}, p\in \{1,\dots,2^k\}$}
\textbf{for }$s\in S\textbf{ do }T_s=(V_s,A_s), V_s\leftarrow \{s\}, E_s\leftarrow\emptyset$\;
$I=\{1,\dots,2^k\}$\\
$T=\{T_s:s\in S\}$\;
$t\leftarrow 0$\;
\While{$V_T\neq V$} {
	$S\leftarrow V_T$\;
	Find a set of pruned binomial trees $B=\{B_1,\dots,B_{|V_T|}\}$ of order at most $k$ with roots in $V_T$ by solving model \eqref{mod:genmatch}\;
	$V_T\leftarrow V_T\cup \{v:v\in V_B:\beta(v)\leq p\}$\;
	$E_T\leftarrow E_T\cup \{\{u,v\}\in E_B: \beta(u)\leq p,\beta(v)\leq p\}$\;
	$t\leftarrow t+1$\;
}
\Return t\;
%\Return $\lceil k/s \rceil$\;
 \caption{A method for determining an upper bound based on iterative search for pruned binomial trees}
\label{alg:match}
\end{algorithm}

Alg. \ref{alg:match} describes the process formally.
Initially, the broadcast forest consists of isolated sources.
The binomial trees are determined by solving the ILP model \eqref{mod:genmatch}. 
Note that in every iteration, the model is solved with a different set $S$, as all nodes already included in the broadcast forest are roots of the binomial trees.
The model considers the entire set $V$, but it is also possible to restrict this set to nodes with distance at most $k$ from some node in $V_T$.
When this restriction is not imposed, nodes with larger distance are not a part of any binomial tree in the current iteration due to \eqref{mod:part:followArcsA} - \eqref{mod:part:followArcsB}.

Not only determine the algorithms the upper bound on the minimum broadcast time, but they also construct a solution with this broadcast time.

%
%We present a simple general method for determining an upper bound on the optimal solution.
%The idea is to construct broadcast trees in parallel from their roots in sources.
%A new node is connected to a tree is it was not connected to any other tree in any of the previous iterations.
%The steps are summarized in Alg. \ref{alg:genub}.
%
%\begin{algorithm}[]
%\KwData{$G=(V,E), S\subseteq V$}
%$U\leftarrow S$;\tcp{Set of marked nodes}
%$T_s=(V_s,A_s), V_s\leftarrow \{s\}, E_s\leftarrow\emptyset$\;
%\While{$|U|<n$} {
%	\For{$s\in S$} {
%		Select $v\in V\setminus U:\exists u\in V_s \text{ s. t.} \{u,v\}\in E$ according to some strategy\; 	
%		$U\leftarrow U\cup\{v\}$\;
%		$V_s\leftarrow V_s\cup\{v\}$\;
%		$A_s\leftarrow A_s\cup\{u,v\}$\;
%	}
%}
%\For{$s\in S$} {
%$	
%\sigma(v)=\begin{cases}
%		0, \text{ if } v\in L(T_s),\\
%		\max\limits_{k\in 1,\dots,|N^+(v)|}\{k+\sigma(j_k):j_k\in N^+(v)\wedge \forall \ell<k:\sigma(j_\ell)>\sigma(j_k)\},\\
%		\hfill \text{ if }v\in V_s\setminus L(T_s).
%
%\end{cases}\;
%$
%}
%\Return $\max_{s\in S}\sigma(s)$\;
%%\Return $\lceil k/s \rceil$\;
% \caption{A method for determining an upper bound}
%\label{alg:genub}
%\end{algorithm}
%The algorithm consists of two phases. 
%In the first phase (lines 3 -- 10), $m$ broadcast trees are constructed.
%The second phase (lines 11 -- 13) uses a recursive formula that determines in linear time an optimal broadcast time for a subtree of $T_s$ rooted at $v\in V_s$.
%The value  $\sigma(s)$ than gives the optimal broadcast time for $T_s$.
%The complexity of Alg. \ref{alg:genub} depends on the strategy according to which the trees are constructed.
%For common strategies such as BFS and DFS it is $\mathcal{O}(n+|E|)$, for the shortest paths trees $\mathcal{O}(|E| + n\log n)$.
%
%
